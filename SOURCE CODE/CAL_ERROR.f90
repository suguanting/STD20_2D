    !######################################################################!
    !#                                                                    #!
    !#                              功能子函数                            #!
    !#                                                                    #!
    !######################################################################!

    !******************************************求解程序空间精度*****************************************************!
    SUBROUTINE CAL_ERROR
    USE DECLARATION
    USE CSV_FILE
    IMPLICIT NONE

    REAL(KIND=8),ALLOCATABLE::DIVC(:,:),DIVR(:,:)
    REAL(KIND=8),ALLOCATABLE::XEXACT(:),YEXACT(:)
    REAL(KIND=8),ALLOCATABLE::XPVEXACT(:),YPUEXACT(:)
    REAL(KIND=8),ALLOCATABLE::UEXACT(:,:),VEXACT(:,:),UPR(:,:),VPR(:,:)!,PEXACT(:,:)
    REAL(KIND=8),ALLOCATABLE::XERROR(:),YERROR(:)
    REAL(KIND=8),ALLOCATABLE::XPVERROR(:),YPUERROR(:)
    REAL(KIND=8),ALLOCATABLE::UERROR(:,:),VERROR(:,:)!,PN(:,:)
    REAL(KIND=8),ALLOCATABLE::ERRORUN(:,:),ERRORVN(:,:)
    REAL(KIND=8),ALLOCATABLE::ERRORUF(:,:),ERRORVF(:,:)

    INTEGER,PARAMETER::NGRADE=8
    CHARACTER(LEN=80)::FILENAME_GRADE(NGRADE)
    REAL(KIND=8)::SPACE_INTERVAL(NGRADE-1)
    REAL(KIND=8)::DATA_U(NGRADE-1,7)
    REAL(KIND=8)::DATA_V(NGRADE-1,7)


    LOGICAL::ALIVE
    INTEGER::ERROR
    INTEGER::IEXACT,JEXACT,IMEXACT,JMEXACT
    REAL(KIND=8)TEMP1,TEMP2,TEMP3,SUM,Q,ERRORDIV
    REAL(KIND=8)ERRORU_INFINITE,ERRORU_1ST,ERRORU_2ND
    REAL(KIND=8)ERRORV_INFINITE,ERRORV_1ST,ERRORV_2ND
    INTEGER::MARK
    CHARACTER(LEN=6)CHAR_DX1,CHAR_DX2
    INTEGER REYNOLDS
    !------筛选比------!
    REAL(KIND=8)::RT1,RT2,RT3,RT4
    INTEGER::FILTER_COUNT

    !------赋值文件名------!
    !!steady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000054-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000090-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000162-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000270-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000450-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000810-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N001350-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N004050-225.PLT"
    !!steady rotation 定常解
    !FILENAME_GRADE(1)="2DXYRe00020N003360-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N002974-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N002864-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N002833-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N002821-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N002816-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N002815-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N002815-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000072-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000120-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000216-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000360-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000600-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N001080-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N001800-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N005400-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000090-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000150-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000270-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000450-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000750-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N001350-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N002250-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N006750-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000060-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000100-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000180-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000300-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000500-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000900-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N001500-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N004500-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000075-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000125-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000225-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000375-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000625-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N001125-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N001875-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N005625-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000012-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000020-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000036-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000060-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000100-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000180-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000300-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N000900-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000018-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000030-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000054-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000090-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000150-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000270-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000450-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N001350-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000018.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000030.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000054.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000090.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000150.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000270.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000450.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N001350.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000030-3.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000050-5.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000090-9.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000150-15.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000250-25.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000450-45.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000750-75.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N002250-225.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000030.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000050.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000090.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000150.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000250.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000450.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000750.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N002250.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00020N000024.PLT"
    !FILENAME_GRADE(2)="2DXYRe00020N000040.PLT"
    !FILENAME_GRADE(3)="2DXYRe00020N000072.PLT"
    !FILENAME_GRADE(4)="2DXYRe00020N000120.PLT"
    !FILENAME_GRADE(5)="2DXYRe00020N000200.PLT"
    !FILENAME_GRADE(6)="2DXYRe00020N000360.PLT"
    !FILENAME_GRADE(7)="2DXYRe00020N000600.PLT"
    !FILENAME_GRADE(8)="2DXYRe00020N001800.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00200N000036.PLT"
    !FILENAME_GRADE(2)="2DXYRe00200N000060.PLT"
    !FILENAME_GRADE(3)="2DXYRe00200N000108.PLT"
    !FILENAME_GRADE(4)="2DXYRe00200N000180.PLT"
    !FILENAME_GRADE(5)="2DXYRe00200N000300.PLT"
    !FILENAME_GRADE(6)="2DXYRe00200N000540.PLT"
    !FILENAME_GRADE(7)="2DXYRe00200N000900.PLT"
    !FILENAME_GRADE(8)="2DXYRe00200N002700.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00200N000048.PLT"
    !FILENAME_GRADE(2)="2DXYRe00200N000080.PLT"
    !FILENAME_GRADE(3)="2DXYRe00200N000144.PLT"
    !FILENAME_GRADE(4)="2DXYRe00200N000240.PLT"
    !FILENAME_GRADE(5)="2DXYRe00200N000400.PLT"
    !FILENAME_GRADE(6)="2DXYRe00200N000720.PLT"
    !FILENAME_GRADE(7)="2DXYRe00200N001200.PLT"
    !FILENAME_GRADE(8)="2DXYRe00200N003600.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00200N000060.PLT"
    !FILENAME_GRADE(2)="2DXYRe00200N000100.PLT"
    !FILENAME_GRADE(3)="2DXYRe00200N000180.PLT"
    !FILENAME_GRADE(4)="2DXYRe00200N000300.PLT"
    !FILENAME_GRADE(5)="2DXYRe00200N000500.PLT"
    !FILENAME_GRADE(6)="2DXYRe00200N000900.PLT"
    !FILENAME_GRADE(7)="2DXYRe00200N001500.PLT"
    !FILENAME_GRADE(8)="2DXYRe00200N004500.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00100N000036.PLT"
    !FILENAME_GRADE(2)="2DXYRe00100N000060.PLT"
    !FILENAME_GRADE(3)="2DXYRe00100N000108.PLT"
    !FILENAME_GRADE(4)="2DXYRe00100N000180.PLT"
    !FILENAME_GRADE(5)="2DXYRe00100N000300.PLT"
    !FILENAME_GRADE(6)="2DXYRe00100N000540.PLT"
    !FILENAME_GRADE(7)="2DXYRe00100N000900.PLT"
    !FILENAME_GRADE(8)="2DXYRe00100N002700.PLT"
    !!unsteady rotation 非定常解
    !FILENAME_GRADE(1)="2DXYRe00100N000048.PLT"
    !FILENAME_GRADE(2)="2DXYRe00100N000080.PLT"
    !FILENAME_GRADE(3)="2DXYRe00100N000144.PLT"
    !FILENAME_GRADE(4)="2DXYRe00100N000240.PLT"
    !FILENAME_GRADE(5)="2DXYRe00100N000400.PLT"
    !FILENAME_GRADE(6)="2DXYRe00100N000720.PLT"
    !FILENAME_GRADE(7)="2DXYRe00100N001200.PLT"
    !FILENAME_GRADE(8)="2DXYRe00100N003600.PLT"
    !unsteady rotation 非定常解
    FILENAME_GRADE(1)="2DXYRe00100N000060.PLT"
    FILENAME_GRADE(2)="2DXYRe00100N000100.PLT"
    FILENAME_GRADE(3)="2DXYRe00100N000180.PLT"
    FILENAME_GRADE(4)="2DXYRe00100N000300.PLT"
    FILENAME_GRADE(5)="2DXYRe00100N000500.PLT"
    FILENAME_GRADE(6)="2DXYRe00100N000900.PLT"
    FILENAME_GRADE(7)="2DXYRe00100N001500.PLT"
    FILENAME_GRADE(8)="2DXYRe00100N004500.PLT"

    DO N=1,NGRADE,1

        INQUIRE(FILE=FILENAME_GRADE(N), EXIST=ALIVE)
        IF(.NOT. ALIVE)THEN
            WRITE(*,*)TRIM(FILENAME_GRADE(N))," DOESN'T EXIST"
            STOP
        END IF

    END DO

    !------给定空间步长------!
    SPACE_INTERVAL(1)=1.0D0/3.0D0
    SPACE_INTERVAL(2)=1.0D0/5.0D0
    SPACE_INTERVAL(3)=1.0D0/9.0D0
    SPACE_INTERVAL(4)=1.0D0/15.0D0
    SPACE_INTERVAL(5)=1.0D0/25.0D0
    SPACE_INTERVAL(6)=1.0D0/45.0D0
    SPACE_INTERVAL(7)=1.0D0/75.0D0

    !---------------读取精确流场-------------------!
    WRITE(CHAR_DX1,'(I6.6)') IDNINT(1.0D0/DX3)
    ALLOCATE( XEXACT(IM),YEXACT(JM) )
    ALLOCATE( XPVEXACT(0:IM),YPUEXACT(0:JM) )
    ALLOCATE( UEXACT(IM,0:JM),VEXACT(0:IM,JM) )
    ALLOCATE( UPR(IM-1,JM-1),VPR(IM-1,JM-1) )
    ALLOCATE( DIVC(IM-1,JM-1),DIVR(IM-1,JM-1) )

    OPEN(50, FILE=FILENAME_GRADE(NGRADE))
    READ(50,*)
    READ(50,*)
    READ(50,*)
    DO J=1,JM-1,1
        DO I=1,IM-1,1
            READ(50,*,IOSTAT=ERROR)TEMP1,TEMP2,UPR(I,J),VPR(I,J),TEMP1,TEMP2,TEMP3,DIVR(I,J)
            IF(ERROR/=0)EXIT
        END DO
    END DO
    CLOSE(50)
    !------U------!
    DO J=1,JM-1,1
        U(1,J)=0.0D0
        DO I=2,IM,1
            U(I,J)=2.0D0*UPR(I-1,J)-U(I-1,J)
        END DO
    END DO
    U(:       ,0       )=-U(:       ,1       )
    U(:       ,JM      )=-U(:       ,JM-1    )
    !------V------!
    DO I=1,IM-1,1
        V(I,1)=0.0D0
        DO J=2,JM,1
            V(I,J)=2.0D0*VPR(I,J-1)-V(I,J-1)
        END DO
    END DO
    V(0       ,:       )=-V(   1    ,:      )
    V(IM      ,:       )=-V(IM-1    ,:      )

    !------赋值------!
    UEXACT=U
    VEXACT=V

    XEXACT=X
    YEXACT=Y
    XPVEXACT=XPV
    YPUEXACT=YPU

    IMEXACT=IM
    JMEXACT=JM

    !------DIV------!
    DO J=1,JM-1,1
        DO I=1,IM-1,1
            DIVC(I,J)=( UEXACT(I+1,J)-UEXACT(I,J) )/( XEXACT(I+1)-XEXACT(I) )+( VEXACT(I,J+1)-VEXACT(I,J) )/( YEXACT(J+1)-YEXACT(J) )
        END DO
    END DO
    ERRORDIV=MAXVAL(DABS(DIVC-DIVR))
    WRITE(*,*) ERRORDIV,MAXLOC(DABS(DIVC-DIVR))


    !-----------------------------循环求解误差-------------------------------!
    DO N=1,NGRADE-1,1

        !---------------读取粗糙流场-------------------!
        DX3 =SPACE_INTERVAL(N)
        WRITE(CHAR_DX2,'(I6.6)') IDNINT(1.0D0/DX3)
        !------确定网格规模------!
        CALL CAL_GRID_SIZE

        DEALLOCATE( U,V,X,Y,XPV,YPU )
        ALLOCATE( X(IM),Y(JM) )
        ALLOCATE( XPV(0:IM),YPU(0:JM) )
        ALLOCATE( U(IM,0:JM),V(0:IM,JM) )

        !------划分固定网格点------!
        CALL MESHING_FIXED

        DEALLOCATE( UPR,VPR )
        DEALLOCATE( DIVC,DIVR )
        IF(ALLOCATED(XERROR))THEN
            DEALLOCATE( XERROR,YERROR )
            DEALLOCATE( XPVERROR,YPUERROR )
            DEALLOCATE( UERROR,VERROR )
        END IF
        ALLOCATE( XERROR(IM),YERROR(JM) )
        ALLOCATE( XPVERROR(0:IM),YPUERROR(0:JM) )
        ALLOCATE( UERROR(IM,0:JM),VERROR(0:IM,JM) )
        ALLOCATE( UPR(IM-1,JM-1),VPR(IM-1,JM-1) )
        ALLOCATE( DIVC(IM-1,JM-1),DIVR(IM-1,JM-1) )

        OPEN(50, FILE=FILENAME_GRADE(N))
        READ(50,*)
        READ(50,*)
        READ(50,*)
        DO J=1,JM-1,1
            DO I=1,IM-1,1
                READ(50,*,IOSTAT=ERROR)TEMP1,TEMP2,UPR(I,J),VPR(I,J),TEMP1,TEMP2,TEMP3,DIVR(I,J)
                IF(ERROR/=0)EXIT
            END DO
        END DO
        CLOSE(50)
        !------U------!
        DO J=1,JM-1,1
            U(1,J)=0.0D0
            DO I=2,IM,1
                U(I,J)=2.0D0*UPR(I-1,J)-U(I-1,J)
            END DO
        END DO
        U(:       ,0       )=-U(:       ,1       )
        U(:       ,JM      )=-U(:       ,JM-1    )
        !------V------!
        DO I=1,IM-1,1
            V(I,1)=0.0D0
            DO J=2,JM,1
                V(I,J)=2.0D0*VPR(I,J-1)-V(I,J-1)
            END DO
        END DO
        V(0       ,:       )=-V(   1    ,:      )
        V(IM      ,:       )=-V(IM-1    ,:      )

        !------赋值------!
        UERROR=U
        VERROR=V

        XERROR=X
        YERROR=Y
        XPVERROR=XPV
        YPUERROR=YPU

        !------DIV------!
        DO J=1,JM-1,1
            DO I=1,IM-1,1
                DIVC(I,J)=( UERROR(I+1,J)-UERROR(I,J) )/( XERROR(I+1)-XERROR(I) )+( VERROR(I,J+1)-VERROR(I,J) )/( YERROR(J+1)-YERROR(J) )
            END DO
        END DO
        ERRORDIV=MAXVAL(DABS(DIVC-DIVR))
        WRITE(*,*) ERRORDIV,MAXLOC(DABS(DIVC-DIVR))
        WRITE(89999,*) YPUERROR
        WRITE(89998,*) YPUEXACT

        !------求解误差------!
        IF(ALLOCATED(ERRORUN))THEN
            DEALLOCATE( ERRORUN,ERRORVN )
        END IF
        ALLOCATE( ERRORUN(IM,1:JM-1),ERRORVN(1:IM-1,JM) )
        !------U------!
        DO J=1,JM-1,1
            DO I=1,IM,1
                MARK=0
                DO IEXACT=1,IMEXACT,1
                    IF( DABS(XERROR(I)-XEXACT(IEXACT))<=1.0D-6 )THEN
                        MARK=1
                        EXIT
                    END IF
                END DO
                IF(MARK==0)WRITE(*,*)"UERRORI",I
                MARK=0
                DO JEXACT=1,JMEXACT-1,1
                    !IF(J==2 .AND. JEXACT==5)WRITE(*,*) YPUERROR(J),YPUEXACT(JEXACT)
                    IF( DABS(YPUERROR(J)-YPUEXACT(JEXACT))<=1.0D-6 )THEN
                        MARK=1
                        EXIT
                    END IF
                END DO
                IF(MARK==0)WRITE(*,*)"UERRORJ",J

                ERRORUN(I,J)=DABS(UERROR(I,J)-UEXACT(IEXACT,JEXACT))

            END DO
        END DO

        !------V------!
        DO J=1,JM,1
            DO I=1,IM-1,1
                MARK=0
                DO IEXACT=1,IMEXACT-1,1
                    IF( DABS(XPVERROR(I)-XPVEXACT(IEXACT))<=1.0D-6 )THEN
                        MARK=1
                        EXIT
                    END IF
                END DO
                IF(MARK==0)WRITE(*,*)"VERRORI",I
                MARK=0
                DO JEXACT=1,JMEXACT,1
                    IF( DABS(YERROR(J)-YEXACT(JEXACT))<=1.0D-6 )THEN
                        MARK=1
                        EXIT
                    END IF
                END DO
                IF(MARK==0)WRITE(*,*)"VERRORJ",J

                ERRORVN(I,J)=DABS(VERROR(I,J)-VEXACT(IEXACT,JEXACT))

            END DO
        END DO

        !---------------求解误差范数-------------------!
        ERRORU_INFINITE=MAXVAL(ERRORUN)
        SUM=0.0D0
        Q=1.0D0
        DO J=1,JM-1,1
            DO I=1,IM,1
                SUM=SUM+ERRORUN(I,J)**Q/DBLE(IM)/DBLE(JM-1)
            END DO
        END DO
        ERRORU_1ST=SUM**(1.0D0/Q)
        SUM=0.0D0
        Q=2.0D0
        DO J=1,JM-1,1
            DO I=1,IM,1
                SUM=SUM+ERRORUN(I,J)**Q/DBLE(IM)/DBLE(JM-1)
            END DO
        END DO
        ERRORU_2ND=SUM**(1.0D0/Q)

        ERRORV_INFINITE=MAXVAL(ERRORVN)
        SUM=0.0D0
        Q=1.0D0
        DO J=1,JM,1
            DO I=1,IM-1,1
                SUM=SUM+ERRORVN(I,J)**Q/DBLE(IM)/DBLE(JM-1)
            END DO
        END DO
        ERRORV_1ST=SUM**(1.0D0/Q)
        SUM=0.0D0
        Q=2.0D0
        DO J=1,JM,1
            DO I=1,IM-1,1
                SUM=SUM+ERRORVN(I,J)**Q/DBLE(IM)/DBLE(JM-1)
            END DO
        END DO
        ERRORV_2ND=SUM**(1.0D0/Q)

        !---------------输出误差云图-------------------!
        OPEN(UNIT=10,FILE='ERROR'//TRIM(CHAR_DX1)//'_'//TRIM(CHAR_DX2)//'.PLT')!,FORM='UNFORMATTED'
        WRITE(10,*) 'TITLE="NONAME"'
        WRITE(10,*) 'VARIABLES="X","Y","ERRORU","ERRORV"'
        WRITE(10,*) 'ZONE T="NONAME", I=',IM-1,', J=',JM-1,', F=POINT'

        DO J=1,IM-1,1
            DO I=1,JM-1,1
                WRITE(10,*) XPVERROR(I),YPUERROR(J),0.5D0*(ERRORUN(I,J)+ERRORUN(I+1,J)),0.5D0*(ERRORVN(I,J)+ERRORVN(I,J+1))
            END DO
        END DO
        CLOSE(10)

        !---------------整理误差-------------------!
        DATA_U(N,1)=SPACE_INTERVAL(N)
        DATA_U(N,2)=ERRORU_INFINITE
        DATA_U(N,3)=ERRORU_1ST
        DATA_U(N,4)=ERRORU_2ND
        DATA_V(N,1)=SPACE_INTERVAL(N)
        DATA_V(N,2)=ERRORV_INFINITE
        DATA_V(N,3)=ERRORV_1ST
        DATA_V(N,4)=ERRORV_2ND

        IF(N>1)THEN
            DATA_U(N,5)=LOG(DATA_U(N-1,2)/DATA_U(N,2))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
            DATA_U(N,6)=LOG(DATA_U(N-1,3)/DATA_U(N,3))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
            DATA_U(N,7)=LOG(DATA_U(N-1,4)/DATA_U(N,4))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
            DATA_V(N,5)=LOG(DATA_V(N-1,2)/DATA_V(N,2))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
            DATA_V(N,6)=LOG(DATA_V(N-1,3)/DATA_V(N,3))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
            DATA_V(N,7)=LOG(DATA_V(N-1,4)/DATA_V(N,4))/LOG(SPACE_INTERVAL(N-1)/SPACE_INTERVAL(N))
        END IF

    END DO

    OPEN(100,FILE='RESULT_U.CSV')
    CALL CSV_WRITE(100, TRANSPOSE(DATA_U))
    CLOSE(100)
    OPEN(100,FILE='RESULT_V.CSV')
    CALL CSV_WRITE(100, TRANSPOSE(DATA_V))
    CLOSE(100)


    !---------------筛选误差分布-------------------!
    ALLOCATE( ERRORUF(IM,JM),ERRORVF(IM,JM) )
    ERRORUF=ERRORUN
    ERRORVF=ERRORVN
    !FILTER_COUNT=0
    !DO J=2,JM-1,1
    !    DO I=2,IM-1,1
    !        RT1=ERRORUN(I,J)/ERRORUN(I+1,J)
    !        RT2=ERRORUN(I,J)/ERRORUN(I-1,J)
    !        RT3=ERRORUN(I,J)/ERRORUN(I,J+1)
    !        RT4=ERRORUN(I,J)/ERRORUN(I,J-1)
    !        IF( (RT1>=100.0D0 .OR. RT2>=100.0D0 .OR. RT3>=100.0D0 .OR. RT4>=100.0D0) .AND. ERRORUN(I,J)>=0.5D0*ERRORU_INFINITE )THEN
    !            ERRORUF(I,J)=0.0D0
    !            FILTER_COUNT=FILTER_COUNT+1
    !        END IF
    !    END DO
    !END DO
    !WRITE(*,*)"U:",FILTER_COUNT
    !
    !FILTER_COUNT=0
    !DO J=2,JM-1,1
    !    DO I=2,IM-1,1
    !        RT1=ERRORVN(I,J)/ERRORVN(I+1,J)
    !        RT2=ERRORVN(I,J)/ERRORVN(I-1,J)
    !        RT3=ERRORVN(I,J)/ERRORVN(I,J+1)
    !        RT4=ERRORVN(I,J)/ERRORVN(I,J-1)
    !        IF( (RT1>=100.0D0 .OR. RT2>=100.0D0 .OR. RT3>=100.0D0 .OR. RT4>=100.0D0) .AND. ERRORVN(I,J)>=0.5D0*ERRORV_INFINITE )THEN
    !            ERRORVF(I,J)=0.0D0
    !            FILTER_COUNT=FILTER_COUNT+1
    !        END IF
    !    END DO
    !END DO
    !WRITE(*,*)"V:",FILTER_COUNT


    !!---------------求解误差范数-------------------!
    !ERRORU_INFINITE=MAXVAL(ERRORUF)
    !SUM=0.0D0
    !Q=1.0D0
    !DO J=1,JM,1
    !    DO I=1,IM,1
    !        SUM=SUM+ERRORUF(I,J)**Q/DBLE(IM-1)**2.0D0
    !    END DO
    !END DO
    !ERRORU_1ST=SUM**(1.0D0/Q)
    !SUM=0.0D0
    !Q=2.0D0
    !DO J=1,JM,1
    !    DO I=1,IM,1
    !        SUM=SUM+ERRORUF(I,J)**Q/DBLE(IM-1)**2.0D0
    !    END DO
    !END DO
    !ERRORU_2ND=SUM**(1.0D0/Q)
    !
    !ERRORV_INFINITE=MAXVAL(ERRORVF)
    !SUM=0.0D0
    !Q=1.0D0
    !DO J=1,JM,1
    !    DO I=1,IM,1
    !        SUM=SUM+ERRORVF(I,J)**Q/DBLE(IM-1)**2.0D0
    !    END DO
    !END DO
    !ERRORV_1ST=SUM**(1.0D0/Q)
    !SUM=0.0D0
    !Q=2.0D0
    !DO J=1,JM,1
    !    DO I=1,IM,1
    !        SUM=SUM+ERRORVF(I,J)**Q/DBLE(IM-1)**2.0D0
    !    END DO
    !END DO
    !ERRORV_2ND=SUM**(1.0D0/Q)
    !
    !OPEN(100,FILE='RESULT2.DAT')
    !WRITE(100,*)ERRORU_INFINITE,ERRORU_1ST,ERRORU_2ND
    !WRITE(100,*)ERRORV_INFINITE,ERRORV_1ST,ERRORV_2ND
    !CLOSE(100)
    !
    !OPEN(UNIT=10,FILE='ERROR2'//TRIM(CHAR_DX1)//'_'//TRIM(CHAR_DX2)//'.PLT')!,FORM='UNFORMATTED'
    !WRITE(10,*) 'TITLE="NONAME"'
    !WRITE(10,*) 'VARIABLES="X","Y","ERRORU","ERRORV"'
    !WRITE(10,*) 'ZONE T="NONAME", I=',IM,', J=',JM,', F=POINT'
    !
    !DO J=1,IM,1
    !    DO I=1,JM,1
    !        WRITE(10,*) XERROR(I),YERROR(J),ERRORUF(I,J),ERRORVF(I,J)
    !    END DO
    !END DO
    !CLOSE(10)


    RETURN
    END SUBROUTINE